import React, { useState, useEffect } from "react";
import { cn } from "@/lib/utils";
import { useLocation, useNavigate } from "react-router-dom";

const MailchimpLogo = () => (
  <svg
    width="32"
    height="32"
    viewBox="0 0 32 32"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      d="M23.0617 15.1951C23.2789 15.1693 23.487 15.1681 23.6769 15.1951C23.7872 14.9448 23.8065 14.5138 23.7064 14.0435C23.5586 13.3453 23.3585 12.9233 22.9458 12.9884C22.533 13.0546 22.5171 13.5597 22.6649 14.2578C22.7479 14.6507 22.8957 14.9863 23.0606 15.194L23.0617 15.1951Z"
      fill="#21262A"
    />
    <path
      d="M19.5142 15.7473C19.8098 15.8753 19.9917 15.9606 20.0622 15.8865C20.1077 15.8405 20.094 15.7518 20.0236 15.6384C19.878 15.4039 19.5778 15.1648 19.2595 15.0312C18.6079 14.754 17.8313 14.846 17.2321 15.2714C17.0343 15.414 16.8466 15.6126 16.8739 15.7327C16.883 15.772 16.9126 15.8012 16.9819 15.8102C17.1445 15.8281 17.7153 15.5442 18.3714 15.5049C18.8353 15.4768 19.2185 15.6194 19.5142 15.7484V15.7473Z"
      fill="#21262A"
    />
    <path
      d="M18.9183 16.0818C18.5329 16.1413 18.3214 16.267 18.1849 16.3838C18.069 16.4836 17.9962 16.5948 17.9973 16.6733C17.9973 16.7104 18.0144 16.7317 18.0269 16.7429C18.044 16.7586 18.0656 16.7665 18.0906 16.7665C18.177 16.7665 18.3726 16.6891 18.3726 16.6891C18.9081 16.4994 19.2617 16.5229 19.6119 16.5622C19.8052 16.5835 19.8973 16.5959 19.9394 16.5297C19.9519 16.5106 19.9667 16.4702 19.928 16.4084C19.8382 16.2636 19.4493 16.0201 18.9183 16.0818Z"
      fill="#21262A"
    />
    <path
      d="M21.8633 17.312C22.1248 17.4388 22.4125 17.3895 22.5069 17.2009C22.6012 17.0123 22.4648 16.7575 22.2033 16.6307C21.9417 16.5039 21.6541 16.5532 21.5597 16.7418C21.4665 16.9304 21.6018 17.1852 21.8633 17.312Z"
      fill="#21262A"
    />
    <path
      d="M23.545 15.8618C23.3324 15.8584 23.1561 16.0886 23.1516 16.3759C23.147 16.6632 23.3153 16.899 23.5268 16.9034C23.7394 16.9068 23.9157 16.6767 23.9202 16.3894C23.9248 16.102 23.7565 15.8663 23.545 15.8618Z"
      fill="#21262A"
    />
    <path
      d="M9.05219 21.0206C8.99306 21.034 8.92711 21.0497 8.85434 21.0486C8.69857 21.0453 8.56553 20.9802 8.49162 20.8668C8.39497 20.7198 8.40066 20.5009 8.50754 20.2506C8.52232 20.2169 8.53938 20.1799 8.55757 20.1383C8.72813 19.7612 9.01353 19.1292 8.69288 18.5276C8.45183 18.0742 8.05955 17.7924 7.58653 17.7329C7.13285 17.6757 6.66553 17.8418 6.36762 18.1662C5.89802 18.678 5.82411 19.3739 5.91507 19.6209C5.94805 19.7107 6.00035 19.7365 6.03788 19.741C6.11747 19.7511 6.23572 19.6938 6.30963 19.4974C6.31532 19.4828 6.32214 19.4615 6.33123 19.4334C6.36421 19.329 6.42561 19.136 6.52681 18.9811C6.64847 18.7936 6.83722 18.6646 7.05894 18.6185C7.28522 18.5703 7.51604 18.6129 7.70933 18.7386C8.03794 18.9508 8.16529 19.3492 8.0243 19.7298C7.95153 19.9262 7.83327 20.3022 7.85942 20.6109C7.91173 21.2361 8.30174 21.4864 8.65081 21.5133C8.99079 21.5257 9.22843 21.3371 9.28869 21.2002C9.32394 21.1182 9.29438 21.0688 9.27505 21.0475C9.22274 20.9824 9.13519 21.0026 9.05105 21.0217L9.05219 21.0206Z"
      fill="#21262A"
    />
    <path
      d="M28.9039 19.9049C28.8914 19.86 28.8061 19.5558 28.6913 19.1887C28.5753 18.8217 28.4559 18.5635 28.4559 18.5635C28.9209 17.8766 28.9289 17.2626 28.8675 16.9147C28.8016 16.4836 28.6196 16.1155 28.2535 15.7361C27.8874 15.3567 27.1369 14.9672 26.084 14.6754C25.9635 14.6417 25.5667 14.534 25.5314 14.5239C25.5291 14.5014 25.5018 13.2375 25.478 12.6943C25.4609 12.3025 25.4268 11.6897 25.2335 11.0869C25.0038 10.2709 24.6047 9.55593 24.1056 9.09909C25.4825 7.69043 26.3421 6.13809 26.3398 4.80687C26.3364 2.24657 23.1504 1.47209 19.2253 3.07606C19.2208 3.0783 18.3998 3.42177 18.3942 3.42514C18.3908 3.42177 16.891 1.96933 16.8682 1.94913C12.3906 -1.90535 -1.60308 13.4486 2.8712 17.1773L3.84906 17.9945C3.5955 18.6432 3.49544 19.3863 3.57731 20.1855C3.68192 21.2114 4.2186 22.1958 5.0873 22.9557C5.9128 23.6774 6.99754 24.1342 8.05045 24.1331C9.79127 28.0931 13.7698 30.5232 18.434 30.6601C23.437 30.8072 27.6372 28.4893 29.3962 24.3262C29.5111 24.0343 30 22.7177 30 21.556C30 20.3942 29.3314 19.9037 28.905 19.9037L28.9039 19.9049ZM8.43477 23.0219C8.28241 23.0477 8.12777 23.0578 7.97086 23.0544C6.45972 23.014 4.82692 21.6716 4.66546 20.0788C4.48581 18.3188 5.39772 16.9641 7.01119 16.643C7.20449 16.6049 7.43758 16.5824 7.68887 16.5959C8.59282 16.6453 9.9243 17.33 10.229 19.274C10.4985 20.9959 10.071 22.748 8.43591 23.0241L8.43477 23.0219ZM6.74739 15.5891C5.74338 15.7821 4.85762 16.3433 4.31639 17.1201C3.99233 16.8541 3.38969 16.3377 3.28395 16.1368C2.41979 14.5171 4.22656 11.3676 5.48982 9.5896C8.60874 5.19299 13.4958 1.86719 15.7585 2.46994C16.1258 2.5732 17.3447 3.96728 17.3447 3.96728C17.3447 3.96728 15.0831 5.20533 12.9864 6.93278C10.1608 9.08001 8.02657 12.2015 6.74739 15.5891ZM12.5099 9.57052C13.6186 8.30552 14.9842 7.20553 16.2076 6.58706C16.2497 6.56574 16.2952 6.61063 16.2713 6.65216C16.1746 6.82614 15.987 7.19767 15.9279 7.47941C15.9188 7.52318 15.9677 7.55685 16.0052 7.53104C16.7659 7.0192 18.0906 6.47033 19.2515 6.39961C19.3015 6.39625 19.3254 6.46023 19.2856 6.48941C19.1094 6.62298 18.9161 6.80818 18.7751 6.99563C18.7512 7.02706 18.7739 7.07308 18.8137 7.07308C19.629 7.07869 20.7786 7.36043 21.5279 7.77573C21.579 7.80379 21.5426 7.90032 21.4858 7.88798C20.3522 7.63094 18.4965 7.43675 16.5692 7.90144C14.8489 8.31563 13.5356 8.95542 12.577 9.64348C12.5281 9.67827 12.4701 9.61542 12.5099 9.57052ZM28.9551 21.9499C28.7379 23.2497 28.1785 24.3037 27.2381 25.2746C26.6662 25.883 25.9703 26.4117 25.1755 26.7967C24.7537 27.0155 24.3034 27.2052 23.8292 27.3579C20.2839 28.5005 16.6556 27.2445 15.4867 24.5462C15.3935 24.343 15.3139 24.1309 15.2525 23.9086C14.7545 22.1307 15.1775 19.9969 16.4998 18.6545C16.5817 18.5692 16.6647 18.4681 16.6647 18.3413C16.6647 18.2358 16.5965 18.1235 16.5374 18.0438C16.0746 17.3816 14.4714 16.2524 14.7931 14.067C15.024 12.4979 16.4146 11.3922 17.7119 11.4573C17.8211 11.463 17.9314 11.4697 18.0405 11.4764C18.6022 11.509 19.0923 11.5808 19.5551 11.5999C20.3294 11.6324 21.0253 11.5213 21.8496 10.8434C22.1282 10.6144 22.3511 10.4157 22.7286 10.3529C22.7684 10.3461 22.8673 10.3113 23.064 10.3203C23.2653 10.3304 23.4574 10.3854 23.6291 10.4988C24.2898 10.9332 24.3841 11.9849 24.4182 12.7538C24.4376 13.1926 24.491 14.2556 24.5103 14.5609C24.5524 15.2579 24.7377 15.3567 25.1141 15.4791C25.3256 15.5475 25.5212 15.5992 25.8111 15.6789C26.6866 15.9213 27.2051 16.1671 27.5315 16.4836C27.727 16.6812 27.8169 16.8911 27.8453 17.0909C27.9488 17.8339 27.2609 18.7521 25.4404 19.5861C23.4506 20.4975 21.0367 20.7287 19.3697 20.5447C19.2413 20.5301 18.7876 20.4795 18.7853 20.4795C17.4516 20.3022 16.6897 22.0038 17.4913 23.17C18.0076 23.921 19.413 24.4103 20.8195 24.4103C24.0441 24.4103 26.5218 23.0511 27.4439 21.8781C27.4712 21.8433 27.4746 21.8388 27.5178 21.7748C27.5633 21.7075 27.5258 21.6705 27.4689 21.7086C26.7162 22.2171 23.3699 24.2375 19.7916 23.6291C19.7916 23.6291 19.3572 23.5584 18.9604 23.4058C18.6455 23.2845 17.9848 22.9848 17.9041 22.3159C20.7922 23.197 22.6103 22.3641 22.6103 22.3641C22.6433 22.3507 22.666 22.3136 22.6615 22.2766C22.657 22.2317 22.616 22.198 22.5705 22.2025C22.5705 22.2025 20.2032 22.5482 17.9666 21.7401C18.21 20.9588 18.8581 21.2406 19.8371 21.3191C21.6018 21.4224 23.1834 21.1687 24.3523 20.8376C25.3654 20.5503 26.6957 19.9846 27.7282 19.1798C28.0761 19.9352 28.2001 20.7669 28.2001 20.7669C28.2001 20.7669 28.4695 20.7198 28.6947 20.8567C28.9073 20.9858 29.0642 21.2552 28.9573 21.9511L28.9551 21.9499ZM18.0337 21.8298C18.0337 21.8298 18.0337 21.8298 18.0337 21.831C18.0337 21.831 18.0337 21.8298 18.0337 21.8287V21.8298Z"
      fill="#21262A"
    />
  </svg>
);

const MenuIcon = () => (
  <svg
    width="24"
    height="24"
    viewBox="0 0 24 24"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      d="M20.025 7.99397L4.02499 7.96997C3.75977 7.96997 3.50542 7.86461 3.31788 7.67708C3.13034 7.48954 3.02499 7.23519 3.02499 6.96997C3.02499 6.70475 3.13034 6.4504 3.31788 6.26286C3.50542 6.07533 3.75977 5.96997 4.02499 5.96997L20.025 5.99397C20.2902 5.99397 20.5446 6.09933 20.7321 6.28686C20.9196 6.4744 21.025 6.72875 21.025 6.99397C21.025 7.25919 20.9196 7.51354 20.7321 7.70108C20.5446 7.88861 20.2902 7.99397 20.025 7.99397Z"
      fill="#21262A"
    />
    <path
      d="M20.018 12.994L4.01799 12.97C3.75277 12.97 3.49842 12.8646 3.31088 12.6771C3.12334 12.4895 3.01799 12.2352 3.01799 11.97C3.01799 11.7048 3.12334 11.4504 3.31088 11.2629C3.49842 11.0753 3.75277 10.97 4.01799 10.97L20.018 10.994C20.2832 10.994 20.5376 11.0993 20.7251 11.2869C20.9126 11.4744 21.018 11.7288 21.018 11.994C21.018 12.2592 20.9126 12.5135 20.7251 12.7011C20.5376 12.8886 20.2832 12.994 20.018 12.994Z"
      fill="#21262A"
    />
    <path
      d="M20.011 17.994L4.01099 17.97C3.74577 17.97 3.49142 17.8646 3.30388 17.6771C3.11634 17.4895 3.01099 17.2352 3.01099 16.97C3.01099 16.7048 3.11634 16.4504 3.30388 16.2629C3.49142 16.0753 3.74577 15.97 4.01099 15.97L20.011 15.994C20.2762 15.994 20.5306 16.0993 20.7181 16.2869C20.9056 16.4744 21.011 16.7288 21.011 16.994C21.011 17.2592 20.9056 17.5135 20.7181 17.7011C20.5306 17.8886 20.2762 17.994 20.011 17.994Z"
      fill="#21262A"
    />
  </svg>
);

const navItems = [
  {
    id: "create",
    label: "Create",
    icon: (
      <svg
        width="20"
        height="20"
        viewBox="0 0 20 20"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M4.69694 14.5455L5.45452 15.3031L13.7879 6.96975L13.0303 6.21218L4.69694 14.5455Z"
          fill="currentColor"
        />
        <path
          fillRule="evenodd"
          clipRule="evenodd"
          d="M14.7575 1.83362L17.9545 4.67838V5.45506L6.21267 17.1969L1.95081 18.0493L2.80229 13.7889L14.7575 1.83362ZM14.803 3.3952L14.0463 4.1519L15.8485 5.95405L16.7102 5.09229L14.803 3.3952ZM3.84917 14.349L13.2428 4.95543L15.0449 6.75758L5.65243 16.1501L3.39915 16.6007L3.84917 14.349Z"
          fill="currentColor"
        />
      </svg>
    ),
    isSpecial: true,
  },
  {
    id: "home",
    label: "Home",
    icon: (
      <svg
        width="20"
        height="20"
        viewBox="0 0 20 20"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          fillRule="evenodd"
          clipRule="evenodd"
          d="M2.49507 18.3333V9.84995L0.820761 11.3049L0 10.3617L9.73632 1.90085L9.99999 1.66663L10.2631 1.90034L20 10.3617L19.1792 11.3049L17.5049 9.84994V18.3333H2.49507ZM8.95764 17.0833H11.0423V13.3333C11.0423 12.758 10.5757 12.2916 9.99999 12.2916C9.42432 12.2916 8.95764 12.758 8.95764 13.3333V17.0833ZM12.2932 17.0833V13.3333C12.2932 12.0676 11.2665 11.0416 9.99999 11.0416C8.73351 11.0416 7.70682 12.0676 7.70682 13.3333V17.0833H3.74589V8.93407L8.36002 4.75334L10 3.32821L11.6397 4.75308L16.2541 8.93407V17.0833H12.2932Z"
          fill="currentColor"
        />
      </svg>
    ),
  },
  {
    id: "campaigns",
    label: "Campaigns",
    icon: (
      <svg
        width="20"
        height="20"
        viewBox="0 0 20 20"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          fillRule="evenodd"
          clipRule="evenodd"
          d="M16.6619 14.1667L11.6539 2.5L0.681788 12.7241C0.512653 12.8817 0.416626 13.1023 0.416626 13.3333C0.416626 13.7936 0.790323 14.1667 1.2513 14.1667H16.6619ZM10.0799 5.67531L11.2043 4.6275L14.7626 12.9167H12.7521L10.0799 5.67531Z"
          fill="currentColor"
        />
        <path
          d="M15.3923 5.89712L17.8963 3.81379L17.0968 2.85288L14.5928 4.93621L15.3923 5.89712Z"
          fill="currentColor"
        />
        <path
          d="M19.4451 7.22586L16.1064 8.89253L15.5481 7.77414L18.8868 6.10747L19.4451 7.22586Z"
          fill="currentColor"
        />
        <path
          d="M7.06311 16.5705V15.4167H5.81109V16.5705L5.81593 16.6809C5.87687 17.3727 6.5054 17.9167 7.27178 17.9167H9.35847L9.47827 17.9122C10.2289 17.856 10.8192 17.2768 10.8192 16.5705V15.4167H9.56714V16.5705L9.56162 16.6146C9.54 16.6996 9.45725 16.7628 9.35847 16.7628H7.27178L7.22393 16.7577C7.13174 16.7378 7.06311 16.6615 7.06311 16.5705Z"
          fill="currentColor"
        />
        <path
          d="M19.5833 11.4583H16.6619V10.2083H19.5833V11.4583Z"
          fill="currentColor"
        />
      </svg>
    ),
  },
  {
    id: "automations",
    label: "Automations",
    icon: (
      <svg
        width="20"
        height="20"
        viewBox="0 0 20 20"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M7.70833 4.16663C7.70833 4.73737 6.81131 4.99996 5.94363 4.99996C5.07594 4.99996 4.375 4.6484 4.375 4.16663C4.375 3.68486 5.07918 3.33329 5.94363 3.33329C6.80808 3.33329 7.70833 3.59805 7.70833 4.16663Z"
          fill="currentColor"
        />
        <path
          fillRule="evenodd"
          clipRule="evenodd"
          d="M3.10733 1.87127C3.83308 1.33712 4.801 1.04163 5.83333 1.04163C6.8287 1.04163 7.88284 1.25472 8.71146 1.73674C9.55679 2.22848 10.2083 3.03423 10.2083 4.16663C10.2083 5.30081 9.56008 6.10718 8.71386 6.59906C7.88543 7.0806 6.83099 7.29163 5.83333 7.29163C4.79794 7.29163 3.82972 6.99632 3.10441 6.46173C2.37362 5.9231 1.875 5.12439 1.875 4.16663C1.875 3.20783 2.37633 2.40929 3.10733 1.87127ZM3.84829 2.878C3.37186 3.22865 3.125 3.68011 3.125 4.16663C3.125 4.65417 3.37113 5.10547 3.84605 5.45551C4.32644 5.80959 5.02489 6.04163 5.83333 6.04163C6.67951 6.04163 7.50007 5.85877 8.08568 5.51837C8.65351 5.18831 8.95833 4.74468 8.95833 4.16663C8.95833 3.59329 8.65335 3.14904 8.08292 2.81722C7.49578 2.47567 6.67492 2.29163 5.83333 2.29163C5.02872 2.29163 4.32997 2.52347 3.84829 2.878Z"
          fill="currentColor"
        />
        <path
          d="M17.2898 6.61869C17.16 4.93046 15.7617 3.54163 14.1667 3.54163H11.25V4.79163H14.1667L14.2866 4.79649C15.1632 4.86744 15.9659 5.70525 16.0435 6.71456C16.1379 7.94232 15.6697 8.66748 14.4317 8.97695C13.9306 9.10223 13.0687 9.17397 11.1843 9.26247L9.17073 9.35278C6.94255 9.45862 5.74684 9.56423 4.98934 9.76844L4.80874 9.82161C2.99646 10.4041 2.29167 11.5553 2.29167 13.3333C2.29167 15.0091 3.42828 16.4583 5 16.4583H7.5V18.3333L10.4167 15.8333L7.5 13.3333V15.2083H5L4.89113 15.2032C4.13632 15.1322 3.54167 14.3288 3.54167 13.3333C3.54167 12.0628 3.93873 11.4142 5.19126 11.0116L5.26573 10.989C5.85864 10.8184 6.96273 10.714 8.97177 10.614L12.1269 10.467C13.3877 10.3988 14.0801 10.3324 14.5822 10.225L14.7349 10.1896C16.592 9.72535 17.4291 8.42916 17.2898 6.61869Z"
          fill="currentColor"
        />
        <path
          fillRule="evenodd"
          clipRule="evenodd"
          d="M11.6667 12.5H18.3333V19.1666H11.6667V12.5ZM17.0833 13.75H12.9167V17.9166H17.0833V13.75Z"
          fill="currentColor"
        />
      </svg>
    ),
  },
  {
    id: "inbox",
    label: "Inbox",
    icon: (
      <svg
        width="20"
        height="20"
        viewBox="0 0 20 20"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          fillRule="evenodd"
          clipRule="evenodd"
          d="M2.5 3.75A1.25 1.25 0 013.75 2.5h12.5A1.25 1.25 0 0117.5 3.75v12.5a1.25 1.25 0 01-1.25 1.25H3.75A1.25 1.25 0 012.5 16.25V3.75zm1.25 0v12.5h12.5V3.75H3.75z"
          fill="currentColor"
        />
        <path
          d="M3.75 5h12.5v1.25H3.75V5zM6.25 8.75h7.5v1.25h-7.5v-1.25zM6.25 11.25h5v1.25h-5v-1.25z"
          fill="currentColor"
        />
      </svg>
    ),
    href: "/inbox",
  },
  {
    id: "audience",
    label: "Audience",
    icon: (
      <svg
        width="20"
        height="20"
        viewBox="0 0 20 20"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <g clipPath="url(#clip0_4_5880)">
          <path
            d="M3.72211 5.51226C3.96471 5.26671 4.36043 5.26432 4.60597 5.50692C5.16802 6.06222 6.08206 6.06222 6.64411 5.50692C6.88965 5.26432 7.28538 5.26671 7.52798 5.51226C7.77058 5.7578 7.76819 6.15352 7.52264 6.39612C6.47369 7.43249 4.77639 7.43249 3.72744 6.39612C3.48189 6.15352 3.47951 5.7578 3.72211 5.51226Z"
            fill="currentColor"
          />
          <path
            d="M13.3081 14.558C13.5522 14.3139 13.9479 14.3139 14.192 14.558C14.7812 15.1473 15.6355 15.1473 16.2248 14.558C16.4688 14.3139 16.8646 14.3139 17.1086 14.558C17.3527 14.8021 17.3527 15.1978 17.1086 15.4419C16.0312 16.5193 14.3855 16.5193 13.3081 15.4419C13.064 15.1978 13.064 14.8021 13.3081 14.558Z"
            fill="currentColor"
          />
          <path
            d="M13.1476 4.67359C12.9021 4.43099 12.5064 4.43338 12.2638 4.67892C12.0212 4.92447 12.0236 5.32019 12.2691 5.56279C13.3181 6.59916 15.0154 6.59916 16.0643 5.56279C16.3099 5.32019 16.3122 4.92447 16.0696 4.67892C15.827 4.43338 15.4313 4.43099 15.1858 4.67359C14.6237 5.22889 13.7097 5.22889 13.1476 4.67359Z"
            fill="currentColor"
          />
          <path
            d="M3.09711 15.5123C3.33971 15.2667 3.73543 15.2643 3.98097 15.5069C4.54302 16.0622 5.45706 16.0622 6.01911 15.5069C6.26465 15.2643 6.66038 15.2667 6.90298 15.5123C7.14558 15.7578 7.14319 16.1535 6.89764 16.3961C5.84869 17.4325 4.15139 17.4325 3.10244 16.3961C2.85689 16.1535 2.85451 15.7578 3.09711 15.5123Z"
            fill="currentColor"
          />
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M1.88907 7.33575C1.48312 6.65173 1.25004 5.85306 1.25004 4.99996C1.25004 2.46865 3.30207 0.416626 5.83337 0.416626C7.75659 0.416626 9.40315 1.60117 10.0833 3.28049C10.8663 2.03469 12.4689 1.24996 14.1667 1.24996C16.5522 1.24996 18.75 2.79926 18.75 4.99996C18.75 5.81224 18.4506 6.53578 17.9529 7.12543C18.4463 7.73777 18.7773 8.36793 18.9397 9.0166C19.1234 9.75053 19.1375 10.6991 18.9919 11.8731L18.9876 11.9053C19.3668 12.5725 19.5834 13.3443 19.5834 14.1666C19.5834 16.6979 17.5313 18.75 15 18.75C14.0982 18.75 13.2572 18.4895 12.5482 18.0397C11.7392 18.2309 10.8843 18.3333 10 18.3333C9.71926 18.3333 9.44143 18.323 9.16708 18.3027L9.16671 19.1666H0.833374V10.8333C0.833374 9.57019 1.215 8.38002 1.88907 7.33575ZM2.50004 4.99996C2.50004 3.15901 3.99242 1.66663 5.83337 1.66663C7.0949 1.66663 8.19274 2.36742 8.75885 3.40094L8.76439 3.41109C8.80122 3.47889 8.83577 3.54811 8.86793 3.61865C9.00975 3.92976 9.10497 4.26642 9.14413 4.61942L9.14521 4.61933C9.15941 4.74424 9.16671 4.87125 9.16671 4.99996C9.16671 6.84091 7.67432 8.33329 5.83337 8.33329C4.90022 8.33329 4.05663 7.94985 3.45156 7.33192C3.42247 7.30223 3.39394 7.27198 3.36598 7.24122C3.10621 6.9554 2.89542 6.62427 2.74686 6.26108L2.74336 6.25027L2.74273 6.25093C2.58623 5.86466 2.50004 5.44237 2.50004 4.99996ZM17.8392 10.5683C17.8484 10.0698 17.8104 9.65304 17.7271 9.32012C17.614 8.86837 17.376 8.40966 17.0074 7.9446C16.2063 8.45688 15.2043 8.74996 14.1667 8.74996C12.4689 8.74996 10.8663 7.96522 10.0833 6.71943C9.40315 8.39874 7.75659 9.58329 5.83337 9.58329C4.63547 9.58329 3.5449 9.12374 2.72835 8.37131C2.31281 9.13093 2.08337 9.9647 2.08337 10.8333H9.16671V17.0491C9.44028 17.0717 9.71828 17.0833 10 17.0833C10.4742 17.0833 10.9377 17.0504 11.3874 16.9875C10.7792 16.2097 10.4167 15.2305 10.4167 14.1666C10.4167 11.6353 12.4687 9.58329 15 9.58329C16.0723 9.58329 17.0585 9.95147 17.8392 10.5683ZM14.3488 17.4364C14.5594 17.4781 14.7772 17.5 15 17.5C16.841 17.5 18.3334 16.0076 18.3334 14.1666C18.3334 12.3257 16.841 10.8333 15 10.8333C13.1591 10.8333 11.6667 12.3257 11.6667 14.1666C11.6667 15.6148 12.5902 16.8473 13.8804 17.3073C14.0318 17.3612 14.1882 17.4046 14.3488 17.4364ZM14.1667 2.49996C12.18 2.49996 10.8334 3.74887 10.8334 4.99996C10.8334 6.25104 12.18 7.49996 14.1667 7.49996C16.1534 7.49996 17.5 6.25104 17.5 4.99996C17.5 3.74887 16.1534 2.49996 14.1667 2.49996ZM2.08337 17.9166V12.0833H7.91671V17.9166H2.08337Z"
            fill="currentColor"
          />
        </g>
        <defs>
          <clipPath id="clip0_4_5880">
            <rect width="20" height="20" fill="white" />
          </clipPath>
        </defs>
      </svg>
    ),
  },
  {
    id: "analytics",
    label: "Analytics",
    icon: (
      <svg
        width="20"
        height="20"
        viewBox="0 0 20 20"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          fillRule="evenodd"
          clipRule="evenodd"
          d="M14.1667 1.66669V19.1667H19.1667V1.66669H14.1667ZM17.9167 2.91669H15.4167V17.9167H17.9167V2.91669Z"
          fill="currentColor"
        />
        <path
          fillRule="evenodd"
          clipRule="evenodd"
          d="M7.50004 6.66669V19.1667H12.5V6.66669H7.50004ZM11.25 7.91669H8.75004V17.9167H11.25V7.91669Z"
          fill="currentColor"
        />
        <path
          fillRule="evenodd"
          clipRule="evenodd"
          d="M0.833374 11.6667H5.83337V19.1667H0.833374V11.6667ZM2.08337 12.9167H4.58337V17.9167H2.08337V12.9167Z"
          fill="currentColor"
        />
      </svg>
    ),
  },
  {
    id: "forms",
    label: "Forms",
    icon: (
      <svg
        width="20"
        height="20"
        viewBox="0 0 20 20"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M11.6667 4.79169H12.7083V15.2084H11.6667V16.4584H15V15.2084H13.9583V4.79169H15V3.54169H11.6667V4.79169Z"
          fill="currentColor"
        />
        <path
          d="M1.875 6.04169H11.6667V7.29169H3.125V12.7084H11.6667V13.9584H1.875V6.04169Z"
          fill="currentColor"
        />
        <path
          d="M18.125 6.04169H15V7.29169H16.875V12.7084H15V13.9584H18.125V6.04169Z"
          fill="currentColor"
        />
      </svg>
    ),
  },
  {
    id: "assets",
    label: "Assets & Brand",
    icon: (
      <svg
        width="20"
        height="20"
        viewBox="0 0 20 20"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          fillRule="evenodd"
          clipRule="evenodd"
          d="M11.2232 7.50002L7.08337 2.91669L5.60053 7.50002H0.833374V13.3334H3.71328L2.50004 17.0834L18.75 15.8334L15.8334 12.6042V7.50002H11.2232ZM9.53875 7.50002L7.60646 5.36069L6.91432 7.50002H9.53875ZM14.8076 13.3334H5.02707L4.26332 15.694L16.1163 14.7823L14.8076 13.3334ZM2.08337 12.0834V8.75002H14.5834V12.0834H2.08337Z"
          fill="currentColor"
        />
        <path
          d="M14.5834 4.16669C17.1147 4.16669 19.1667 6.21872 19.1667 8.75002C19.1667 9.99622 18.6693 11.1263 17.8623 11.9525L16.9961 11.0499C17.5665 10.4518 17.9167 9.64179 17.9167 8.75002C17.9167 6.90907 16.4243 5.41669 14.5834 5.41669C13.7405 5.41669 12.9706 5.72955 12.3837 6.24548L11.5168 5.3436C12.329 4.61199 13.4042 4.16669 14.5834 4.16669Z"
          fill="currentColor"
        />
      </svg>
    ),
  },
  {
    id: "integrations",
    label: "Integrations",
    icon: (
      <svg
        width="20"
        height="20"
        viewBox="0 0 20 20"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          fillRule="evenodd"
          clipRule="evenodd"
          d="M1.66663 9.16669V1.66669H9.16663V9.16669H1.66663ZM2.91663 2.91669H7.91663V7.91669H2.91663V2.91669Z"
          fill="currentColor"
        />
        <path
          fillRule="evenodd"
          clipRule="evenodd"
          d="M10.8333 18.3334V10.8334H18.3333V18.3334H10.8333ZM12.0833 12.0834H17.0833V17.0834H12.0833V12.0834Z"
          fill="currentColor"
        />
        <path
          fillRule="evenodd"
          clipRule="evenodd"
          d="M1.66663 10.8334V18.3334H9.16663V10.8334H1.66663ZM7.91663 12.0834H2.91663V17.0834H7.91663V12.0834Z"
          fill="currentColor"
        />
        <path
          fillRule="evenodd"
          clipRule="evenodd"
          d="M10.8333 9.16669V1.66669H18.3333V9.16669H10.8333ZM12.0833 2.91669H17.0833V7.91669H12.0833V2.91669Z"
          fill="currentColor"
        />
      </svg>
    ),
  },
];

interface MailchimpNavigationProps {
  className?: string;
}

export function MailchimpNavigation({ className }: MailchimpNavigationProps) {
  const location = useLocation();
  const navigate = useNavigate();
  const [isMobile, setIsMobile] = useState(false);
  const [isCollapsed, setIsCollapsed] = useState(false);

  useEffect(() => {
    const checkMobile = () => {
      const mobile = window.innerWidth < 768;
      console.log('Navigation mobile check:', mobile, 'Width:', window.innerWidth);
      setIsMobile(mobile);
      // On mobile, start collapsed, but always show the header area
      setIsCollapsed(mobile);
      console.log('Navigation collapsed set to:', mobile);
    };

    const handleMobileNavToggle = (event: CustomEvent) => {
      console.log('Navigation toggle event:', event.detail);
      setIsCollapsed(!event.detail);
    };

    checkMobile();
    window.addEventListener('resize', checkMobile);
    window.addEventListener('toggleMobileNav', handleMobileNavToggle as EventListener);

    return () => {
      window.removeEventListener('resize', checkMobile);
      window.removeEventListener('toggleMobileNav', handleMobileNavToggle as EventListener);
    };
  }, []);

  const isActive = (item: any) => {
    if (item.href) {
      return location.pathname === item.href;
    }
    if (item.id === "audience") {
      return location.pathname.startsWith("/audience") || location.pathname === "/";
    }
    return false;
  };

  const handleNavClick = (item: any) => {
    if (item.href) {
      navigate(item.href);
    } else if (item.id === "home") {
      navigate("/home");
    } else if (item.id === "audience") {
      navigate("/audience");
    }

    // Close mobile menu after navigation
    if (isMobile) {
      setIsCollapsed(true);
      // Dispatch event to communicate menu is closed
      window.dispatchEvent(new CustomEvent('toggleMobileNav', { detail: false }));
    }
  };

  return (
    <>
      {/* Mobile overlay when navigation menu is open */}
      {isMobile && !isCollapsed && (
        <div
          className="fixed inset-0 bg-black bg-opacity-50 z-40"
          onClick={() => {
            setIsCollapsed(true);
            // Dispatch event to hide navigation and show hamburger again
            window.dispatchEvent(new CustomEvent('toggleMobileNav', { detail: false }));
          }}
        />
      )}

      <div
        className={cn(
          "flex flex-col items-start flex-shrink-0 bg-[#F0F4F6] transition-all duration-300",
          isMobile
            ? (isCollapsed ? "hidden" : "w-60 fixed left-0 top-0 h-full z-50")
            : "w-60 self-stretch",
          className,
        )}
      >
        {/* Brand stripe */}
        <div className="h-1 self-stretch bg-[#FFE01C]" />

        {/* Navigation switch */}
        <div className="flex px-[10px] py-3 justify-between items-center self-stretch">
          <MailchimpLogo />
          <button
            className="flex w-6 h-6 justify-center items-center cursor-pointer hover:opacity-70"
            onClick={() => setIsCollapsed(!isCollapsed)}
          >
            <MenuIcon />
          </button>
        </div>

        {/* Primary navigation */}
        <div className="flex py-5 px-0 flex-col items-start gap-2 self-stretch">
          {/* Create button */}
          <div className="flex items-start self-stretch">
            <div className="flex px-3 flex-col justify-center items-start flex-1">
              <div className="flex py-1.5 px-1 pr-1 pl-2 items-center gap-2 self-stretch rounded-mailchimp border border-[#D5DEE3] bg-white">
                <div className="w-5 h-5 text-[#4C555B]">{navItems[0].icon}</div>
                <div className="flex-1 text-[#4C555B] font-normal text-sm leading-5">
                  {navItems[0].label}
                </div>
              </div>
            </div>
          </div>

          {/* Nav items */}
          <div className="flex flex-col items-center gap-1 self-stretch">
            {navItems.slice(1).map((item) => (
              <div
                key={item.id}
                className={cn(
                  "flex flex-col items-center self-stretch",
                  item.hasSubNav && "pb-0.5",
                )}
              >
                <div className="flex px-3 flex-col justify-center items-start self-stretch">
                  <div
                    className={cn(
                      "flex py-1.5 px-1 pr-1 pl-2 items-center gap-2 self-stretch rounded-mailchimp cursor-pointer",
                      isActive(item) ? "bg-[#E2E9ED]" : "hover:bg-[#E2E9ED]",
                    )}
                    onClick={() => handleNavClick(item)}
                  >
                    <div
                      className={cn(
                        "w-5 h-5",
                        isActive(item) ? "text-[#21262A]" : "text-[#5D686F]",
                      )}
                    >
                      {item.icon}
                    </div>
                    <div
                      className={cn(
                        "flex-1 font-medium text-sm leading-5",
                        isActive(item)
                          ? "text-[#21262A] font-medium tracking-[-0.14px]"
                          : "text-[#4C555B] font-normal",
                      )}
                    >
                      {item.label}
                    </div>
                  </div>
                </div>

                {/* Sub-navigation items */}
                {item.hasSubNav && item.subNavItems && (
                  <>
                    {item.subNavItems.map((subItem, index) => (
                      <div
                        key={index}
                        className="flex w-60 px-3 flex-col justify-center items-start"
                      >
                        <div className="flex py-1.5 px-1 pr-1 pl-9 justify-center items-center gap-2 self-stretch rounded-mailchimp">
                          <div className="flex-1 text-[#4C555B] font-normal text-sm leading-5">
                            {subItem.label}
                          </div>
                        </div>
                      </div>
                    ))}
                  </>
                )}
              </div>
            ))}
          </div>
        </div>
      </div>
    </>
  );
}
